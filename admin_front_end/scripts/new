tableBody.addEventListener('click', (event) => {
    if (event.target.tagName !== 'TD') return;
    const clickedRow = event.target.closest('tr');
    if (!clickedRow) return;
    userId = clickedRow.cells[1].textContent;

    
    fetchUserDetails(userId)
        .then(userDetails => {
            const userId = userDetails.user_id;
            const doctorId = userDetails.doctor_id;
            const medicationId = userDetails.medication_id;

            return fetchRelatedData(userId, doctorId, medicationId).then(([userData, doctorData, medicationData]) => {
                updateUserStatusDiv(userDetails, userData, doctorData, medicationData);
                showUserStatusDiv();
            });
        })
        .catch(error => {
            console.error("Error fetching user details or related data:", error);
        });
});